<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>TAMU Check-In Form - Print Preview</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 10pt;
            /* Reduced base font size for a better fit */
            background-color: #EEE;
        }

        .page {
            background: white;
            width: 210mm;
            min-height: 297mm;
            /* Use min-height to be flexible */
            padding: 15mm;
            margin: 10mm auto;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .form-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
            border: 1px solid black;
            /* Reduced margin */
        }

        .form-table td {
            padding: 2px 4px;
            /* Reduced padding */
            vertical-align: bottom;
            line-height: 1.2;
            /* Tighter line height */
        }

        .input-line {
            border-bottom: 1px solid black;
            height: 18px;
            /* Slightly shorter lines */
            position: relative;
        }

        .input-data {
            position: absolute;
            bottom: 2px;
            left: 2px;
            font-weight: bold;
            font-size: 9.5pt;
            /* Smaller font for input data */
        }

        .checkbox {
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 1px solid black;
            margin-right: 4px;
            text-align: center;
            line-height: 12px;
            /* Adjusted for smaller box */
            font-weight: bold;
            font-size: 10pt;
            transform: translateY(2px);
            /* Align checkbox with text */
        }

        .header {
            text-align: center;
            font-weight: bold;
            font-size: 14pt;
            margin-bottom: 5px;
        }

        .sub-header {
            text-align: center;
            font-weight: bold;
            font-size: 9pt;
            margin-bottom: 5px;
        }

        .confidential-box {
            border: 2px solid black;
            padding: 4px;
            text-align: center;
            font-weight: bold;
            margin: 15px 0;
        }

        .section-title {
            font-weight: bold;
            margin-top: 15px;
            margin-bottom: 5px;
        }

        .consent-text {
            font-size: 8pt;
            /* Made consent text smaller */
            margin-top: 20px;
            text-align: justify;
        }

        .signature-section {
            display: flex;
            justify-content: space-between;
            margin-top: 80px;
            /* Reduced margin */
            padding: 0 5px;
        }

        .signature-box {
            width: 45%;
            border-top: 1px solid black;
            padding-top: 5px;
            position: relative;
            height: 50px;
            /* Give the signature area a defined height */
        }

        .signature-image {
            position: absolute;
            bottom: 20px;
            left: 20px;
            width: 150px;
            height: 60px;
        }

        .office-use-box {
            border: 2px solid black;
            padding: 10px;
            margin-top: 25px;
        }

        @media print {
            body {
                background: white;
                margin: 0;
            }

            .page {
                margin: 0;
                padding: 10mm;
                box-shadow: none;
                border: none;
            }

            @page {
                size: A4;
                margin: 0;
            }
        }
    </style>
</head>

<body>
    <div class="page">
        <!-- Header Section -->
        <table style="width: 100%; border: none;">
            <tr>
                <!-- Empty cell where address used to be -->
                <td style="width: 50%; vertical-align: top;"></td>
                <td style="width: 50%; text-align: right; vertical-align: top; padding-right: 10px;">
                    Voucher No: <span id="printVoucherNo" style="font-weight: bold;"></span>
                </td>
            </tr>
        </table>

        <h2 class="header" style="margin-top: 20px;">PRESENTATION CHECK - IN FORM</h2>
        <p class="sub-header">THANK YOU FOR ATTENDING OUR PRESENTATION TODAY. YOUR PARTICIPATION IS GREATLY APPRECIATED.
        </p>
        <p class="sub-header">HAVE A PLEASANT EXPERIENCE!!!</p>

        <div class="confidential-box">INFORMATION GIVEN HERE IS STRICTLY PRIVATE AND CONFIDENTIAL</div>

        <!-- Personal Details -->
        <table class="form-table">
            <tr>
                <td style="width: 10%;">NAME (MR):</td>
                <td style="width: 35%;" class="input-line"><span id="printGuestName" class="input-data"></span></td>
                <td style="width: 5%;">NRIC:</td>
                <td style="width: 25%;" class="input-line"><span id="printGuestNric" class="input-data"></span></td>
                <td style="width: 5%;">AGE:</td>
                <td style="width: 20%;" class="input-line"><span id="printGuestAge" class="input-data"></span></td>
            </tr>
            <tr>
                <td>NAME (MRS):</td>
                <td class="input-line"><span id="printPartnerName" class="input-data"></span></td>
                <td>NRIC:</td>
                <td class="input-line"><span id="printPartnerNric" class="input-data"></span></td>
                <td>AGE:</td>
                <td class="input-line"><span id="printPartnerAge" class="input-data"></span></td>
            </tr>
            <tr>
                <td>ADDRESS:</td>
                <td colspan="5" class="input-line"><span id="printAddress" class="input-data"></span></td>
            </tr>
            <tr>
                <td></td>
                <td colspan="5" class="input-line"></td>
            </tr>
            <tr>
                <td>EMAIL:</td>
                <td colspan="5" class="input-line"><span id="printEmail" class="input-data"></span></td>
            </tr>
            <tr>
                <td>TELEPHONE (MR) H/P:</td>
                <td colspan="2" class="input-line"><span id="printGuestPhone" class="input-data"></span></td>
                <td>(MRS) H/P:</td>
                <td colspan="2" class="input-line"><span id="printPartnerPhone" class="input-data"></span></td>
            </tr>
        </table>

        <!-- Marital Status & Children -->
        <p class="section-title">PLEASE TICK WHERE APPLICABLE:-</p>
        <table class="form-table">
            <tr>
                <td style="width: 15%;">MARITAL STATUS:</td>
                <td><span id="printMaritalSingle" class="checkbox"></span> SINGLE</td>
                <td><span id="printMaritalMarried" class="checkbox"></span> MARRIED</td>
                <td><span id="printMaritalOthers" class="checkbox"></span> OTHERS</td>
                <td style="width: 40%;"></td>
            </tr>
            <tr>
                <td style="padding-top: 10px;">NUMBER OF CHILDREN:</td>
                <td colspan="4" class="input-line" style="padding-top: 10px;"><span id="printNumChildren"
                        class="input-data"></span></td>
            </tr>
        </table>

        <!-- Occupation -->
        <p class="section-title">OCCUPATION:</p>
        <table class="form-table">
            <tr>
                <td style="width: 10%;">HUSBAND:</td>
                <td style="width: 40%;" class="input-line"><span id="printGuestOccupation" class="input-data"></span>
                </td>
                <td style="width: 10%;">COMPANY:</td>
                <td style="width: 40%;" class="input-line"><span id="printGuestCompany" class="input-data"></span></td>
            </tr>
            <tr>
                <td>WIFE:</td>
                <td class="input-line"><span id="printPartnerOccupation" class="input-data"></span></td>
                <td>COMPANY:</td>
                <td class="input-line"><span id="printPartnerCompany" class="input-data"></span></td>
            </tr>
        </table>

        <!-- Income -->
        <p class="section-title">GROSS MONTHLY INCOME:</p>
        <table class="form-table">
            <tr>
                <td style="width: 10%;">HUSBAND:</td>
                <td style="width: 40%;">
                    <div><span id="printGuestIncome1" class="checkbox"></span> RM4,000 - RM6,000</div>
                    <div><span id="printGuestIncome2" class="checkbox"></span> RM6,001 - RM10,000</div>
                    <div><span id="printGuestIncome3" class="checkbox"></span> RM10,001 ABOVE</div>
                </td>
                <td style="width: 10%;">WIFE:</td>
                <td style="width: 40%;">
                    <div><span id="printPartnerIncome1" class="checkbox"></span> RM4,000 - RM6,000</div>
                    <div><span id="printPartnerIncome2" class="checkbox"></span> RM6,001 - RM10,000</div>
                    <div><span id="printPartnerIncome3" class="checkbox"></span> RM10,001 ABOVE</div>
                </td>
            </tr>
        </table>

        <!-- Credit Card -->
        <table class="form-table" style="margin-top: 15px;">
            <tr>
                <td style="width: 25%;">ARE YOU A CREDIT CARD HOLDER:-</td>
                <td><span class="checkbox"></span> YES</td>
                <td><span class="checkbox"></span> NO</td>
                <td style="width: 50%;"></td>
            </tr>
            <tr>
                <td></td>
                <td><span class="checkbox"></span> PLATINUM</td>
                <td><span class="checkbox"></span> GOLD</td>
                <td><span class="checkbox"></span> CLASSIC</td>
            </tr>
            <tr>
                <td>CARD ISSUING BANK:</td>
                <td colspan="3" class="input-line"></td>
            </tr>
        </table>

        <!-- Consent -->
        <div class="consent-text">
            <p><strong>CONSENT OF THE DATA PROTECTION AND PRIVACY:</strong></p>
            <p>We assure you that all personal data will be treated as confidential and we will implement the
                appropriate steps of procedures in accordance with the law, rules and regulations to ensure the
                protection of personal data and prevent unauthorised and unlawful usage, accidental access or
                disclosure, alteration or destruction of your personal data.</p>
            <p>I agree that TAMU CAPITAL BERHAD shall have the right to use my personal data for the purpose of the
                operational process which might include transfer of data and personal information to its related
                companies, subsidiaries and/or its holding company, outsourcing partners, and solicitor but not limited
                to affiliate companies including their outsourcing partners. I further agree that TAMU CAPITAL BERHAD
                and its related companies, subsidiareis and/or its holding company can share and use my data and
                personal information for the purpose of promoting the company's and its related companies',
                subsidiaries' and/or its holding company's products, new services and support requirement, and marketing
                campaigns and activities and commercial transaction.</p>
        </div>

        <!-- Signature -->
        <div class="signature-section">
            <div class="signature-box" id="printGuestSignatureContainer">
                Signature:
            </div>
            <div class="signature-box" id="printPartnerSignatureContainer">
                Signature:
            </div>
        </div>

        <!-- Office Use -->
        <div class="office-use-box">
            <strong>FOR OFFICE USE ONLY:</strong>
            <table class="" style="margin-top: 10px;">
                <tr>
                    <td style="width: 10%;">DAY:</td>
                    <td class="input-line"></td>
                    <td style="width: 10%;">DATE:</td>
                    <td class="input-line"></td>
                </tr>
                <tr>
                    <td style="width: 10%;">TIME IN:</td>
                    <td class="input-line"></td>
                    <td style="width: 10%;">TIME OUT:</td>
                    <td class="input-line"></td>
                </tr>
                <tr>
                    <td style="width: 10%;">TM CODE:</td>
                    <td class="input-line"></td>
                    <td style="width: 10%;">CONSULTANT:</td>
                    <td class="input-line"></td>
                </tr>
                <tr>
                    <td colspan="4" style="padding-top: 15px; width: 100%;">
                        <span class="checkbox"></span> QT
                        <span class="checkbox" style="margin-left: 30px;"></span> NQ
                        <span class="checkbox" style="margin-left: 30px;"></span> RESCHEDULED
                    </td>
                </tr>
            </table>
        </div>

    </div>

    <script>
        // --- CORRECTED SCRIPT LOGIC ---
        window.onload = function () {
            const dataString = localStorage.getItem('tamuPrintData');
            if (!dataString) { document.body.innerHTML = '<h1>Error: No data found.</h1>'; return; }

            const data = JSON.parse(dataString);
            const p1 = data.part1;

            const setText = (id, value) => { const el = document.getElementById(id); if (el && value) el.textContent = value; };
            const calculateAge = (dob) => { if (!dob) return ''; const birthDate = new Date(dob); const today = new Date(); let age = today.getFullYear() - birthDate.getFullYear(); const m = today.getMonth() - birthDate.getMonth(); if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) { age--; } return age; };

            if (p1.guestInfo) {
                // Determine which name to put in which box based on gender
                if (p1.guestInfo.gender === 'Male') {
                    setText('printGuestName', p1.guestInfo.fullName);
                    setText('printGuestNric', p1.guestInfo.icPassport);
                    setText('printGuestAge', calculateAge(p1.guestInfo.dob));
                    setText('printGuestPhone', p1.guestInfo.phone);
                } else {
                    setText('printPartnerName', p1.guestInfo.fullName);
                    setText('printPartnerNric', p1.guestInfo.icPassport);
                    setText('printPartnerAge', calculateAge(p1.guestInfo.dob));
                    setText('printPartnerPhone', p1.guestInfo.phone);
                }

                setText('printAddress', `${p1.guestInfo.correspondentAddress}, ${p1.guestInfo.poskod} ${p1.guestInfo.city}`);
                setText('printEmail', p1.guestInfo.email);
                setText('printNumChildren', p1.guestInfo.numChildren);
                if (p1.guestInfo.maritalStatus) {
                    const maritalEl = document.getElementById('printMarital' + p1.guestInfo.maritalStatus);
                    if (maritalEl) maritalEl.textContent = '✓';
                }
            }

            if (p1.guestBusiness) {
                if (p1.guestInfo.gender === 'Male') {
                    setText('printGuestOccupation', p1.guestBusiness.occupation);
                    setText('printGuestCompany', p1.guestBusiness.industry);
                    const income = p1.guestBusiness.monthlyIncome;
                    if (income) {
                        if (income === '4k-6k') document.getElementById('printGuestIncome1').textContent = '✓';
                        if (income === '6k-10k') document.getElementById('printGuestIncome2').textContent = '✓';
                        if (income === '10k+') document.getElementById('printGuestIncome3').textContent = '✓';
                    }
                } else {
                    setText('printPartnerOccupation', p1.guestBusiness.occupation);
                    setText('printPartnerCompany', p1.guestBusiness.industry);
                    const income = p1.guestBusiness.monthlyIncome;
                    if (income) {
                        if (income === '4k-6k') document.getElementById('printPartnerIncome1').textContent = '✓';
                        if (income === '6k-10k') document.getElementById('printPartnerIncome2').textContent = '✓';
                        if (income === '10k+') document.getElementById('printPartnerIncome3').textContent = '✓';
                    }
                }
            }

            if (p1.partnerInfo && p1.partnerInfo.fullName) {
                if (p1.partnerInfo.gender === 'Female') {
                    setText('printPartnerName', p1.partnerInfo.fullName);
                    setText('printPartnerNric', p1.partnerInfo.icPassport);
                    setText('printPartnerAge', calculateAge(p1.partnerInfo.dob));
                    setText('printPartnerPhone', p1.partnerInfo.phone);
                } else {
                    setText('printGuestName', p1.partnerInfo.fullName);
                    setText('printGuestNric', p1.partnerInfo.icPassport);
                    setText('printGuestAge', calculateAge(p1.partnerInfo.dob));
                    setText('printGuestPhone', p1.partnerInfo.phone);
                }
            }

            if (p1.partnerBusiness && p1.partnerInfo.fullName) {
                if (p1.partnerInfo.gender === 'Female') {
                    setText('printPartnerOccupation', p1.partnerBusiness.occupation);
                    setText('printPartnerCompany', p1.partnerBusiness.industry);
                    const p_income = p1.partnerBusiness.monthlyIncome;
                    if (p_income) {
                        if (p_income === '4k-6k') document.getElementById('printPartnerIncome1').textContent = '✓';
                        if (p_income === '6k-10k') document.getElementById('printPartnerIncome2').textContent = '✓';
                        if (p_income === '10k+') document.getElementById('printPartnerIncome3').textContent = '✓';
                    }
                } else {
                    setText('printGuestOccupation', p1.partnerBusiness.occupation);
                    setText('printGuestCompany', p1.partnerBusiness.industry);
                    const p_income = p1.partnerBusiness.monthlyIncome;
                    if (p_income) {
                        if (p_income === '4k-6k') document.getElementById('printGuestIncome1').textContent = '✓';
                        if (p_income === '6k-10k') document.getElementById('printGuestIncome2').textContent = '✓';
                        if (p_income === '10k+') document.getElementById('printGuestIncome3').textContent = '✓';
                    }
                }
            }

            // This part is speculative as signatures are not part of part 1
            if (data.signatures && data.signatures.applicant && data.signatures.applicant.signatureData) {
                const sigImg = `<img src="${data.signatures.applicant.signatureData}" class="signature-image">`;
                document.getElementById('printGuestSignatureContainer').innerHTML += sigImg;
            }
            if (data.signatures && data.signatures.nominee && data.signatures.nominee.signatureData) {
                const sigImg = `<img src="${data.signatures.nominee.signatureData}" class="signature-image">`;
                document.getElementById('printPartnerSignatureContainer').innerHTML += sigImg;
            }

            setTimeout(() => {
                window.print();
                localStorage.removeItem('tamuPrintData');
            }, 500);
        };
    </script>

</body>

</html>