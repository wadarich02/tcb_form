<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>TAMU Check-In Form - Print Preview</title>
    <style>
        /* Base page setup for A4 */
        body {
            font-family: Arial, sans-serif;
            font-size: 8pt;
            background-color: #EEE;
            margin: 0;
        }

        .page {
            background: white;
            width: 210mm;
            height: 297mm;
            padding: 10mm;
            margin: 10mm auto;
            box-sizing: border-box;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        }

        /* Base table styles - reduced spacing */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 8px;
            border: 1px solid #ddd;
        }

        td {
            padding: 4px 4px;
            vertical-align: middle;
        }

        .line {
            border-bottom: 1px solid #ccc;
            min-height: 1.2em;
            padding: 2px 4px;
            font-weight: normal;
            font-size: 9pt;
            background: #f9f9f9;
            border-radius: 2px;
        }

        /* Checkbox styling - compact */
        .checkbox-item {
            display: inline-flex;
            align-items: center;
            margin: 0 10px 0 0;
            padding: 2px 0;
        }

        .box {
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 1px solid #ccc;
            border-radius: 2px;
            text-align: center;
            line-height: 12px;
            margin-right: 4px;
            background: white;
        }

        /* Section titles - reduced margins */
        .section-title {
            font-weight: 600;
            margin: 12px 0 6px;
            padding-bottom: 3px;
            border-bottom: 2px solid #eee;
            color: #333;
        }

        .main-title {
            text-align: center;
            font-weight: 600;
            font-size: 13pt;
            margin: 15px 0 8px;
            color: #333;
        }

        .sub-title {
            text-align: center;
            font-weight: normal;
            font-size: 8.5pt;
            margin: 4px 0;
            color: #666;
        }

        .confidential-box {
            border: 2px solid #e0e0e0;
            padding: 6px;
            text-align: center;
            font-weight: 600;
            margin: 12px 0;
            background: #f8f8f8;
            border-radius: 3px;
            color: #444;
        }

        .flex-container {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 4px 0;
        }

        .occupation-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 4px 0;
        }

        .occupation-row>div:first-child {
            width: 80px;
            flex-shrink: 0;
        }

        .occupation-row .line {
            flex: 1;
            margin-right: 10px;
        }

        .company-label {
            width: 50px;
            flex-shrink: 0;
        }

        .income-section {
            margin: 8px 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 3px;
            padding: 8px;
        }

        .income-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 4px 0;
        }

        .income-row>div:first-child {
            width: 80px;
            flex-shrink: 0;
        }

        .income-options {
            display: flex;
            flex-wrap: nowrap;
            gap: 15px;
        }

        .consent-section {
            font-size: 7.5pt;
            margin: 15px 0;
            padding: 10px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 3px;
            line-height: 1.3;
            text-align: justify;
        }

        .consent-section p {
            margin: 4px 0;
        }

        .signature-section {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
            width: 60%;
        }

        .sig-line {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sig-line.with-signature {
            flex: 2;
        }

        .signature-underline {
            flex: 1;
            border-bottom: 1px solid #000;
            min-width: 200px;
            max-width: 300px;
            height: 30px;
            position: relative;
        }

        #printGuestSignature {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            text-align: center;
        }

        #printGuestSignature img {
            max-height: 30px;
            max-width: 100%;
        }

        .date-underline {
            border-bottom: 1px solid #000;
            min-width: 120px;
            max-width: 150px;
            text-align: center;
        }

        .office-use-box {
            border: 1px solid #ddd;
            padding: 5px;
            margin-top: 10px;
            background: white;
            border-radius: 3px;
        }

        @media print {
            body {
                background: white;
            }

            .page {
                margin: 0;
                padding: 10mm;
                box-shadow: none;
                border: none;
                height: 297mm;
                page-break-after: always;
            }
        }

        .title-cell {
            width: 100px;
        }

        .header-container {
            display: flex;
            align-items: center;
            padding: 8px 15px;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 15px;
            gap: 15px;
        }

        .logo-container {
            flex: 0 0 30%;
            height: 100%;
            display: flex;
            align-items: center;
        }

        .logo {
            width: 100%;
            height: auto;
            max-height: 1.6cm;
            object-fit: contain;
        }

        .contact-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 2px;
            font-size: 10px;
            line-height: 1.2;
        }
    </style>
</head>

<body>
    <div class="page">
        <div class="header-container">
            <div class="logo-container">
                <img src="TCB_LOGO.png" alt="TAMU Logo" class="logo">
            </div>
            <div class="contact-info">
                <div>Aras 8, No. 53, Jalan Raja Alang Kampung Baru, 53000 Kuala Lumpur</div>
                <div><strong>T:</strong> +603 2698 8789  |  <strong>F:</strong> +603 2692 4789</div>
                <div style="color: #2563eb;"><strong>E:</strong> memberservices@tamucapital.com</div>
                <div>Voucher No: <span id="printVoucherNo"></span></div>
            </div>
        </div>

        <div class="main-title">PRESENTATION CHECK-IN FORM</div>
        <div class="sub-title">THANK YOU FOR ATTENDING OUR PRESENTATION TODAY. YOUR PARTICIPATION IS GREATLY
            APPRECIATED.</div>
        <div class="sub-title">HAVE A PLEASANT EXPERIENCE!!!</div>
        <div class="confidential-box">INFORMATION GIVEN HERE IS STRICTLY PRIVATE AND CONFIDENTIAL</div>

        <table class="details-table">
            <tr>
                <td class="title-cell">NAME (MR):</td>
                <td class="line" id="printGuestName"></td>
                <td>NRIC:</td>
                <td class="line" id="printGuestNric"></td>
                <td>AGE:</td>
                <td class="line" id="printGuestAge"></td>
            </tr>
            <tr>
                <td>NAME (MRS):</td>
                <td class="line" id="printPartnerName"></td>
                <td>NRIC:</td>
                <td class="line" id="printPartnerNric"></td>
                <td>AGE:</td>
                <td class="line" id="printPartnerAge"></td>
            </tr>
            <tr>
                <td>ADDRESS:</td>
                <td colspan="5" class="line" id="printAddress"></td>
            </tr>
            <tr>
                <td colspan="6" class="line" style="height: 1.5em;"></td>
            </tr>
            <tr>
                <td>EMAIL:</td>
                <td colspan="5" class="line" id="printEmail"></td>
            </tr>
            <tr>
                <td>(MR) H/P:</td>
                <td colspan="2" class="line" id="printGuestPhone"></td>
                <td>(MRS) H/P:</td>
                <td colspan="2" class="line" id="printPartnerPhone"></td>
            </tr>
        </table>

        <div class="section-title">PLEASE TICK WHERE APPLICABLE:-</div>
        <div class="flex-container">
            <div>MARITAL STATUS:</div>
            <div class="checkbox-item"><span class="box" id="printMaritalSingle"></span> SINGLE</div>
            <div class="checkbox-item"><span class="box" id="printMaritalMarried"></span> MARRIED</div>
            <div class="checkbox-item"><span class="box" id="printMaritalOthers"></span> OTHERS</div>
            <div>| NUMBER OF CHILDREN:</div>
            <div class="line" id="printNumChildren" style="flex-grow: 1;"></div>
        </div>

        <div class="section-title">OCCUPATION:</div>
        <div class="occupation-row">
            <div class="company-label">HUSBAND:</div>
            <div class="line" id="printGuestOccupation"></div>
            <div class="company-label">INDUSTRY:</div>
            <div class="line" id="printGuestCompany"></div>
        </div>
        <div class="occupation-row">
            <div class="company-label">WIFE:</div>
            <div class="line" id="printPartnerOccupation"></div>
            <div class="company-label">INDUSTRY:</div>
            <div class="line" id="printPartnerCompany"></div>
        </div>

        <div class="section-title">GROSS MONTHLY INCOME:</div>
        <div class="income-section">
            <div class="income-row">
                <div class="company-label">HUSBAND:</div>
                <div class="income-options">
                    <div class="checkbox-item"><span class="box" id="printGuestIncome1"></span> RM1k-RM2k</div>
                    <div class="checkbox-item"><span class="box" id="printGuestIncome2"></span> RM2,001-RM4k</div>
                    <div class="checkbox-item"><span class="box" id="printGuestIncome3"></span> RM4,001-RM6k</div>
                    <div class="checkbox-item"><span class="box" id="printGuestIncome4"></span> RM6,001-RM10k</div>
                    <div class="checkbox-item"><span class="box" id="printGuestIncome5"></span> RM10,001-RM15k</div>
                    <div class="checkbox-item"><span class="box" id="printGuestIncome6"></span> RM15,001-RM20k</div>
                    <div class="checkbox-item"><span class="box" id="printGuestIncome7"></span> RM20,001 ></div>
                </div>
            </div>
            <div class="income-row">
                <div class="company-label">WIFE:</div>
                <div class="income-options">
                    <div class="checkbox-item"><span class="box" id="printPartnerIncome1"></span> RM1k-RM2k</div>
                    <div class="checkbox-item"><span class="box" id="printPartnerIncome2"></span> RM2,001-RM4k</div>
                    <div class="checkbox-item"><span class="box" id="printPartnerIncome3"></span> RM4,001-RM6k</div>
                    <div class="checkbox-item"><span class="box" id="printPartnerIncome4"></span> RM6,001-RM10k</div>
                    <div class="checkbox-item"><span class="box" id="printPartnerIncome5"></span> RM10,001-RM15k</div>
                    <div class="checkbox-item"><span class="box" id="printPartnerIncome6"></span> RM15,001-RM20k</div>
                    <div class="checkbox-item"><span class="box" id="printPartnerIncome7"></span> RM20,001 ></div>
                </div>
            </div>
        </div>

        <!-- This section seems to be missing from the main form, but I'll leave placeholders -->
        <div class="flex-container" style="margin-top: 15px;">
            <div>ARE YOU A CREDIT CARD HOLDER:-</div>
            <div class="checkbox-item"><span class="box" id="printCCYes"></span> YES</div>
            <div class="checkbox-item"><span class="box" id="printCCNo"></span> NO</div> |
            <div class="checkbox-item"><span class="box" id="printCCPlatinum"></span> PLATINUM</div>
            <div class="checkbox-item"><span class="box" id="printCCGold"></span> GOLD</div>
            <div class="checkbox-item"><span class="box" id="printCCClassic"></span> CLASSIC</div>
        </div>
        <div class="flex-container">
            <div>CARD ISSUING BANK:</div>
            <div class="line" id="printCCBank" style="flex-grow: 1;"></div>
        </div>

        <div class="consent-section">
            <div class="">CONSENT OF THE DATA PROTECTION AND PRIVACY:</div>
            <p>We assure you that all personal data will be treated as confidential and we will implement the
                appropriate steps of procedures in accordance with the law, rules and regulations to ensure the
                protection of personal data and prevent unauthorised and unlawful usage, accidental access or
                disclosure, alteration or destruction of your personal data.</p>
            <p>I agree that <strong>TAMU CAPITAL BERHAD</strong> shall have the right to use my personal data for the
                purpose of the
                operational process which might include transfer of data and personal information to its related
                companies, subsidiaries and/or its holding company,
                outsourcing partners, and solicitor but not limited to affiliate companies including their outsourcing
                partners. I further agree that <strong>TAMU CAPITAL BERHAD</strong> and
                its related companies, subsidiareis and/or its holding company can share and use my data and personal
                information for the purpose of promoting the
                company's and its related companies', subsidiaries' and/or its holding company's products, new services
                and support requirement, and marketing
                campaigns and activities and commercial transaction.</p>
        </div>

        <div class="signature-section">
            <div class="sig-line with-signature">
                <span>Signature:</span>
                <div class="signature-underline">
                    <div id="printGuestSignature"></div>
                </div>
            </div>
            <div class="sig-line">
                <span>Date:</span>
                <div class="date-underline">
                    <span id="printSignatureDate"></span>
                </div>
            </div>
        </div>

        <div class="office-use-box">
            <div class="section-title" style="text-align: center;">FOR OFFICE USE ONLY:</div>
            <table class="office-use-table">
                <tr>
                    <td style="width: 10%;">DAY:</td>
                    <td class="line" id="printOfficeDay" style="width: 40%;"></td>
                    <td style="width: 10%;">DATE:</td>
                    <td class="line" id="printOfficeDate" style="width: 40%;"></td>
                </tr>
                <tr>
                    <td style="width: 10%;">TIME IN:</td>
                    <td class="line" id="printOfficeTimeIn" style="width: 40%;"></td>
                    <td style="width: 10%;">TIME OUT:</td>
                    <td class="line" id="printOfficeTimeOut" style="width: 40%;"></td>
                </tr>
                <tr>
                    <td style="width: 10%;">TM CODE:</td>
                    <td class="line" id="printOfficeTmCode" style="width: 40%;"></td>
                    <td style="width: 10%;">CONSULTANT:</td>
                    <td class="line" id="printOfficeConsultant" style="width: 40%;"></td>
                </tr>
            </table>
            <div class="flex-container" style="margin-top: 10px; justify-content: space-around;">
                <div class="checkbox-item"><span class="box" id="printOfficeStatusQT"></span> QT</div>
                <div class="checkbox-item"><span class="box" id="printOfficeStatusNQ"></span> NQ</div>
                <div class="checkbox-item"><span class="box" id="printOfficeStatusRescheduled"></span> RESCHEDULED</div>
            </div>
        </div>
    </div>

    <script>
        window.onload = function () {
            const dataString = localStorage.getItem('tamuPrintData');
            if (!dataString) {
                document.body.innerHTML = '<h1>Error: No data found. Please generate from the main form.</h1>';
                return;
            }
            const data = JSON.parse(dataString);
            const p1 = data.part1;

            const setText = (id, value) => { const el = document.getElementById(id); if (el && value) el.textContent = value; };
            const setCheck = (id) => { const el = document.getElementById(id); if (el) el.textContent = '✓'; };
            const setSignature = (id, url) => { const container = document.getElementById(id); if (container && url) { const img = document.createElement('img'); img.src = url; img.style = "max-height: 50px; max-width: 180px;"; container.appendChild(img); } };
            const calculateAge = (dob) => { if (!dob) return ''; const birthDate = new Date(dob); const today = new Date(); let age = today.getFullYear() - birthDate.getFullYear(); const m = today.getMonth() - birthDate.getMonth(); if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) { age--; } return age; };

            let guestIsMr = p1.guestInfo.gender === 'Male';
            let partnerIsMrs = p1.partnerInfo.fullName && p1.partnerInfo.gender === 'Female';
            const mrInfo = guestIsMr ? p1.guestInfo : (p1.partnerInfo.gender === 'Male' ? p1.partnerInfo : {});
            const mrsInfo = partnerIsMrs ? p1.partnerInfo : (p1.guestInfo.gender === 'Female' ? p1.guestInfo : {});
            const mrBiz = guestIsMr ? p1.guestBusiness : (p1.partnerInfo.gender === 'Male' ? p1.partnerBusiness : {});
            const mrsBiz = partnerIsMrs ? p1.partnerBusiness : (p1.guestInfo.gender === 'Female' ? p1.guestBusiness : {});

            // Populate guest and partner info
            setText('printGuestName', mrInfo.fullName);
            setText('printGuestNric', mrInfo.icPassport);
            setText('printGuestAge', calculateAge(mrInfo.dob));
            setText('printGuestPhone', mrInfo.phone);
            setText('printPartnerName', mrsInfo.fullName);
            setText('printPartnerNric', mrsInfo.icPassport);
            setText('printPartnerAge', calculateAge(mrsInfo.dob));
            setText('printPartnerPhone', mrsInfo.phone);

            // Populate address and contact
            setText('printAddress', `${p1.guestInfo.correspondentAddress}, ${p1.guestInfo.poskod} ${p1.guestInfo.city}`);
            setText('printEmail', p1.guestInfo.email);
            setText('printNumChildren', p1.guestInfo.numChildren);

            // Populate checkboxes
            if (p1.guestInfo.maritalStatus === 'Single') setCheck('printMaritalSingle');
            if (p1.guestInfo.maritalStatus === 'Married') setCheck('printMaritalMarried');
            if (p1.guestInfo.maritalStatus === 'Others') setCheck('printMaritalOthers');

            // Populate occupation
            setText('printGuestOccupation', mrBiz.occupation);
            setText('printGuestCompany', mrBiz.industry);
            setText('printPartnerOccupation', mrsBiz.occupation);
            setText('printPartnerCompany', mrsBiz.industry);

            // Populate income
            const setIncomeCheck = (income, prefix) => {
                if (!income) return;
                if (income === '1,000-2,000') setCheck(prefix + '1');
                if (income === '2,001-4,000') setCheck(prefix + '2');
                if (income === '4,001-6,000') setCheck(prefix + '3');
                if (income === '6,001-10,000') setCheck(prefix + '4');
                if (income === '10,001-15,000') setCheck(prefix + '5');
                if (income === '15,001-20,000') setCheck(prefix + '6');
                if (income === '20,001 and above') setCheck(prefix + '7');
            };
            setIncomeCheck(mrBiz.monthlyIncome, 'printGuestIncome');
            setIncomeCheck(mrsBiz.monthlyIncome, 'printPartnerIncome');

            // Populate signature
            if (p1.guestCheckInSignature) {
                setSignature('printGuestSignature', p1.guestCheckInSignature.signatureData);
                setText('printSignatureDate', p1.guestCheckInSignature.date);
            }

            // Populate Office Use Only
            if (p1.officeUse) {
                setText('printOfficeDay', p1.officeUse.day);
                setText('printOfficeDate', p1.officeUse.date);
                setText('printOfficeTimeIn', p1.officeUse.timeIn);
                setText('printOfficeTimeOut', p1.officeUse.timeOut);
                setText('printOfficeTmCode', p1.officeUse.tmCode);
                setText('printOfficeConsultant', p1.officeUse.consultant);
                if (p1.officeUse.status === 'QT') setCheck('printOfficeStatusQT');
                if (p1.officeUse.status === 'NQ') setCheck('printOfficeStatusNQ');
                if (p1.officeUse.status === 'RESCHEDULED') setCheck('printOfficeStatusRescheduled');
            }

            setTimeout(() => { window.print(); }, 500);
        };
    </script>
</body>

</html>