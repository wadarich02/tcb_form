<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>TAMU Check-In Form - Print Preview</title>
    <style>
        /* CSS Optimized for a Single A4 Page */
        body {
            font-family: Arial, sans-serif;
            font-size: 9.5pt;
            /* Base font size reduced slightly */
            background-color: #EEE;
            margin: 0;
        }

        .page {
            background: white;
            width: 210mm;
            /* Set a fixed height and use overflow to see if it fits.
                   For printing, the browser will handle it. */
            height: 296mm;
            padding: 10mm;
            /* Reduced padding to gain space */
            margin: 10mm auto;
            box-sizing: border-box;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        }

        .header-box {
            border: 1px solid black;
            padding: 4px;
            width: 190px;
            font-size: 8.5pt;
            line-height: 1.2;
        }

        .voucher-no {
            text-align: right;
            margin-top: -45px;
            /* Adjusted position */
        }

        .main-title {
            text-align: center;
            font-weight: bold;
            font-size: 13pt;
            margin-top: 15px;
            /* Reduced margin */
        }

        .sub-title {
            text-align: center;
            font-weight: bold;
            font-size: 8.5pt;
            margin-top: 4px;
        }

        .confidential-box {
            border: 2px solid black;
            padding: 3px;
            text-align: center;
            font-weight: bold;
            margin: 10px 0;
            /* Reduced margin */
        }

        .details-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 8px;
        }

        .details-table td {
            padding: 3px;
            /* Reduced padding */
            vertical-align: bottom;
        }

        .line {
            border-bottom: 1px solid black;
            min-height: 1em;
            /* Reduced height */
            padding: 0 2px;
            font-weight: bold;
            font-size: 9pt;
            /* Smaller font for data */
        }

        .section-title {
            font-weight: bold;
            margin-top: 10px;
            /* Reduced margin */
            margin-bottom: 4px;
        }

        .flex-container {
            display: flex;
            align-items: baseline;
            margin-top: 5px;
            /* Reduced margin */
            gap: 8px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 4px;
            margin: 0 8px;
            font-size: 9pt;
        }

        .box {
            display: inline-block;
            width: 11px;
            height: 11px;
            border: 1px solid black;
            text-align: center;
            line-height: 11px;
            font-weight: bold;
        }

        .income-section {
            display: flex;
            justify-content: space-between;
        }

        .income-col {
            width: 48%;
        }

        .consent-section {
            font-size: 7.5pt;
            /* Reduced font for legal text */
            margin-top: 15px;
            /* Reduced margin */
            text-align: justify;
            line-height: 1.1;
        }

        .consent-section p {
            margin-bottom: 4px;
        }

        .signature-section {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            /* Reduced margin significantly */
        }

        .sig-line {
            width: 45%;
            border-top: 1px solid black;
            padding-top: 5px;
        }

        .office-use-box {
            border: 2px solid black;
            padding: 8px;
            margin-top: 20px;
            /* Reduced margin */
        }

        .office-use-table {
            width: 100%;
            border-collapse: collapse;
        }

        .office-use-table td {
            padding: 4px;
        }

        @media print {
            body {
                background: white;
            }

            .page {
                margin: 0;
                padding: 10mm;
                /* Keep some padding for printing */
                box-shadow: none;
                border: none;
                height: auto;
                /* Let the printer decide the height */
            }
        }
    </style>
</head>

<body>
    <div class="page">
        <div class="header-box">
            51C-L1 Mezzanine Floor<br>
            Bangunan Podium 53 Jalan Raja<br>
            Alang Kampung Baru 53000 Kuala<br>
            Lumpur
        </div>
        <div class="voucher-no">Voucher No: <span id="printVoucherNo"></span></div>

        <div class="main-title">PRESENTATION CHECK - IN FORM</div>
        <div class="sub-title">THANK YOU FOR ATTENDING OUR PRESENTATION TODAY. YOUR PARTICIPATION IS GREATLY
            APPRECIATED.</div>
        <div class="sub-title">HAVE A PLEASANT EXPERIENCE!!!</div>

        <div class="confidential-box">INFORMATION GIVEN HERE IS STRICTLY PRIVATE AND CONFIDENTIAL</div>

        <table class="details-table">
            <tr>
                <td>NAME (MR):</td>
                <td class="line" id="printGuestName"></td>
                <td>NRIC:</td>
                <td class="line" id="printGuestNric"></td>
                <td>AGE:</td>
                <td class="line" id="printGuestAge"></td>
            </tr>
            <tr>
                <td>NAME (MRS):</td>
                <td class="line" id="printPartnerName"></td>
                <td>NRIC:</td>
                <td class="line" id="printPartnerNric"></td>
                <td>AGE:</td>
                <td class="line" id="printPartnerAge"></td>
            </tr>
            <tr>
                <td>ADDRESS:</td>
                <td colspan="5" class="line" id="printAddress"></td>
            </tr>
            <tr>
                <td colspan="6" class="line" style="height: 1.5em;"></td>
            </tr>
            <tr>
                <td>EMAIL:</td>
                <td colspan="5" class="line" id="printEmail"></td>
            </tr>
            <tr>
                <td>TELEPHONE (MR) H/P:</td>
                <td colspan="2" class="line" id="printGuestPhone"></td>
                <td>(MRS) H/P:</td>
                <td colspan="2" class="line" id="printPartnerPhone"></td>
            </tr>
        </table>

        <div class="section-title">PLEASE TICK WHERE APPLICABLE:-</div>
        <div class="flex-container">
            <div>MARITAL STATUS:</div>
            <div class="checkbox-item"><span class="box" id="printMaritalSingle"></span> SINGLE</div>
            <div class="checkbox-item"><span class="box" id="printMaritalMarried"></span> MARRIED</div>
            <div class="checkbox-item"><span class="box" id="printMaritalOthers"></span> OTHERS</div>
        </div>
        <div class="flex-container">
            <div>NUMBER OF CHILDREN:</div>
            <div class="line" id="printNumChildren" style="flex-grow: 1;"></div>
        </div>

        <div class="section-title">OCCUPATION:</div>
        <div class="flex-container">
            <div style="width: 15%;">HUSBAND:</div>
            <div class="line" style="width: 35%;" id="printGuestOccupation"></div>
            <div style="width: 15%; text-align: right; padding-right: 5px;">COMPANY:</div>
            <div class="line" style="width: 35%;" id="printGuestCompany"></div>
        </div>
        <div class="flex-container">
            <div style="width: 15%;">WIFE:</div>
            <div class="line" style="width: 35%;" id="printPartnerOccupation"></div>
            <div style="width: 15%; text-align: right; padding-right: 5px;">COMPANY:</div>
            <div class="line" style="width: 35%;" id="printPartnerCompany"></div>
        </div>

        <div class="section-title">GROSS MONTHLY INCOME:</div>
        <div class="income-section">
            <div class="income-col">
                <div>HUSBAND:</div>
                <div class="checkbox-item"><span class="box" id="printGuestIncome1"></span> RM4,000 - RM6,000</div>
                <div class="checkbox-item"><span class="box" id="printGuestIncome2"></span> RM6,001 - RM10,000</div>
                <div class="checkbox-item"><span class="box" id="printGuestIncome3"></span> RM10,001 - RM 15,000</div>
                <div class="checkbox-item"><span class="box" id="printGuestIncome4"></span> RM15,001 - RM 20,000</div>
                <div class="checkbox-item"><span class="box" id="printGuestIncome5"></span> RM20,001 ABOVE</div>
            </div>
            <div class="income-col">
                <div>WIFE:</div>
                <div class="checkbox-item"><span class="box" id="printPartnerIncome1"></span> RM4,000 - RM6,000</div>
                <div class="checkbox-item"><span class="box" id="printPartnerIncome2"></span> RM6,001 - RM10,000</div>
                <div class="checkbox-item"><span class="box" id="printPartnerIncome3"></span> RM10,001 - RM15,000</div>
                <div class="checkbox-item"><span class="box" id="printPartnerIncome4"></span> RM15,001 - RM 20,000</div>
                <div class="checkbox-item"><span class="box" id="printPartnerIncome5"></span> RM20,001 ABOVE</div>
            </div>
        </div>

        <div class="flex-container" style="margin-top: 15px;">
            <div>ARE YOU A CREDIT CARD HOLDER:-</div>
            <div class="checkbox-item"><span class="box" id="printCCYes"></span> YES</div>
            <div class="checkbox-item"><span class="box" id="printCCNo"></span> NO</div>
        </div>
        <div class="flex-container" style="justify-content: center; margin-left: 100px;">
            <div class="checkbox-item"><span class="box" id="printCCPlatinum"></span> PLATINUM</div>
            <div class="checkbox-item"><span class="box" id="printCCGold"></span> GOLD</div>
            <div class="checkbox-item"><span class="box" id="printCCClassic"></span> CLASSIC</div>
        </div>
        <div class="flex-container">
            <div>CARD ISSUING BANK:</div>
            <div class="line" id="printCCBank" style="flex-grow: 1;"></div>
        </div>

        <div class="consent-section">
            <div class="section-title">CONSENT OF THE DATA PROTECTION AND PRIVACY:</div>
            <p>We assure you that all personal data will be treated as confidential and we will implement the
                appropriate steps of procedures in accordance with the law, rules and regulations to ensure the
                protection of personal data and prevent unauthorised and unlawful usage, accidental access or
                disclosure, alteration or destruction of your personal data.</p>
            <p>I agree that <strong>TAMU CAPITAL BERHAD</strong> shall have the right to use my personal data for the
                purpose of the operational process which might include transfer of data and personal information to its
                related companies, subsidiaries and/or its holding company, outsourcing partners, and solicitor but not
                limited to affiliate companies including their outsourcing partners. I further agree that TAMU CAPITAL
                BERHAD and its related companies, subsidiareis and/or its holding company can share and use my data and
                personal information for the purpose of promoting the company's and its related companies',
                subsidiaries' and/or its holding company's products, new services and support requirement, and marketing
                campaigns and activities and commercial transaction.</p>
        </div>

        <div class="signature-section">
            <div class="sig-line"><span>Signature:</span></div>
            <div class="sig-line"><span>Signature:</span></div>
        </div>

        <div class="office-use-box">
            <div class="section-title" style="text-align: center;">FOR OFFICE USE ONLY:</div>
            <table class="office-use-table">
                <tr>
                    <td style="width: 10%;">DAY:</td>
                    <td class="line"></td>
                    <td style="width: 10%;">DATE:</td>
                    <td class="line"></td>
                </tr>
                <tr>
                    <td style="width: 10%;">TIME IN:</td>
                    <td class="line"></td>
                    <td style="width: 10%;">TIME OUT:</td>
                    <td class="line"></td>
                </tr>
                <tr>
                    <td style="width: 10%;">TM CODE:</td>
                    <td class="line"></td>
                    <td style="width: 10%;">CONSULTANT:</td>
                    <td class="line"></td>
                </tr>
            </table>
            <div class="flex-container" style="margin-top: 10px; justify-content: space-around;">
                <div class="checkbox-item"><span class="box"></span> QT</div>
                <div class="checkbox-item"><span class="box"></span> NQ</div>
                <div class="checkbox-item"><span class="box"></span> RESCHEDULED</div>
            </div>
        </div>
    </div>

    <script>
        window.onload = function () {
            const dataString = localStorage.getItem('tamuPrintData');
            if (!dataString) {
                document.body.innerHTML = '<h1>Error: No data found. Please generate from the main form.</h1>';
                return;
            }
            const data = JSON.parse(dataString);
            const p1 = data.part1;

            const setText = (id, value) => { const el = document.getElementById(id); if (el && value) el.textContent = value; };
            const setCheck = (id) => { const el = document.getElementById(id); if (el) el.textContent = '✓'; };
            const calculateAge = (dob) => {
                if (!dob) return '';
                const birthDate = new Date(dob);
                const today = new Date();
                let age = today.getFullYear() - birthDate.getFullYear();
                const m = today.getMonth() - birthDate.getMonth();
                if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                    age--;
                }
                return age;
            };

            // Determine who is Mr. and Mrs. based on gender
            let guestIsMr = p1.guestInfo.gender === 'Male';
            let partnerIsMrs = p1.partnerInfo.fullName && p1.partnerInfo.gender === 'Female';

            const mrInfo = guestIsMr ? p1.guestInfo : (p1.partnerInfo.gender === 'Male' ? p1.partnerInfo : {});
            const mrsInfo = partnerIsMrs ? p1.partnerInfo : (p1.guestInfo.gender === 'Female' ? p1.guestInfo : {});

            const mrBiz = guestIsMr ? p1.guestBusiness : (p1.partnerInfo.gender === 'Male' ? p1.partnerBusiness : {});
            const mrsBiz = partnerIsMrs ? p1.partnerBusiness : (p1.guestInfo.gender === 'Female' ? p1.guestBusiness : {});

            // Populate fields
            setText('printGuestName', mrInfo.fullName);
            setText('printGuestNric', mrInfo.icPassport);
            setText('printGuestAge', calculateAge(mrInfo.dob));
            setText('printGuestPhone', mrInfo.phone);

            setText('printPartnerName', mrsInfo.fullName);
            setText('printPartnerNric', mrsInfo.icPassport);
            setText('printPartnerAge', calculateAge(mrsInfo.dob));
            setText('printPartnerPhone', mrsInfo.phone);

            setText('printAddress', `${p1.guestInfo.correspondentAddress}, ${p1.guestInfo.poskod} ${p1.guestInfo.city}`);
            setText('printEmail', p1.guestInfo.email);
            setText('printNumChildren', p1.guestInfo.numChildren);

            if (p1.guestInfo.maritalStatus === 'Single') setCheck('printMaritalSingle');
            if (p1.guestInfo.maritalStatus === 'Married') setCheck('printMaritalMarried');
            if (p1.guestInfo.maritalStatus === 'Others') setCheck('printMaritalOthers');

            setText('printGuestOccupation', mrBiz.occupation);
            setText('printGuestCompany', mrBiz.industry);
            setText('printPartnerOccupation', mrsBiz.occupation);
            setText('printPartnerCompany', mrsBiz.industry);

            const setIncomeCheck = (income, prefix) => {
                if (!income) return;
                if (income === '4,000-6,000') setCheck(prefix + '1');
                if (income === '6,001-10,000') setCheck(prefix + '2');
                if (income === '10,001-15,000') setCheck(prefix + '3');
                if (income === '15,001-20,000') setCheck(prefix + '4');
                if (income === '20,001 and above') setCheck(prefix + '5');
            };

            setIncomeCheck(mrBiz.monthlyIncome, 'printGuestIncome');
            setIncomeCheck(mrsBiz.monthlyIncome, 'printPartnerIncome');

            // After a short delay, trigger the print dialog
            setTimeout(() => {
                window.print();
            }, 500);
        };
    </script>
</body>

</html>