<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>TAMU Check-In Form - Print Preview</title>
    <style>
        /* Base page setup for A4 */
        body {
            font-family: Arial, sans-serif;
            font-size: 8pt;
            background-color: #EEE;
            margin: 0;
        }

        .page {
            background: white;
            width: 210mm;
            height: 297mm;
            padding: 10mm;
            margin: 10mm auto;
            box-sizing: border-box;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        }

        /* Base table styles - reduced spacing */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 8px;
            border: 1px solid #ddd;
        }

        td {
            padding: 4px 4px;
            vertical-align: middle;
        }

        .line {
            border-bottom: 1px solid #ccc;
            min-height: 1.2em;
            padding: 2px 4px;
            font-weight: normal;
            font-size: 9pt;
            background: #f9f9f9;
            border-radius: 2px;
        }

        /* Checkbox styling - compact */
        .checkbox-item {
            display: inline-flex;
            align-items: center;
            margin: 0 10px 0 0;
            padding: 2px 0;
            white-space: nowrap;
        }

        .box {
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 1px solid #ccc;
            border-radius: 2px;
            text-align: center;
            line-height: 12px;
            margin-right: 4px;
            background: white;
        }

        /* Section titles - reduced margins */
        .section-title {
            font-weight: 600;
            margin: 12px 0 6px;
            padding-bottom: 3px;
            border-bottom: 2px solid #eee;
            color: #333;
        }

        .main-title {
            text-align: center;
            font-weight: 600;
            font-size: 13pt;
            margin: 15px 0 8px;
            color: #333;
        }

        .sub-title {
            text-align: center;
            font-weight: normal;
            font-size: 8.5pt;
            margin: 4px 0;
            color: #666;
        }

        .confidential-box {
            border: 2px solid #e0e0e0;
            padding: 6px;
            text-align: center;
            font-weight: 600;
            margin: 12px 0;
            background: #f8f8f8;
            border-radius: 3px;
            color: #444;
        }

        .flex-container {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 4px 0;
        }

        .occupation-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 4px 0;
        }

        .occupation-row>div:first-child {
            width: 80px;
            flex-shrink: 0;
        }

        .occupation-row .line {
            flex: 1;
            margin-right: 10px;
        }

        .company-label {
            width: 50px;
            flex-shrink: 0;
        }

        .income-section {
            margin: 8px 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 3px;
            padding: 8px;
        }

        .income-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            width: 100%;
        }

        .income-column {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .income-column-title {
            font-weight: bold;
            padding-bottom: 5px;
            border-bottom: 1px solid #eee;
        }

        .income-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            font-size: 7.5pt;
        }

        .income-checkbox {
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .income-checkbox .box {
            flex-shrink: 0;
        }

        .consent-section {
            font-size: 7.5pt;
            margin: 15px 0;
            padding: 10px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 3px;
            line-height: 1.3;
            text-align: justify;
        }

        .consent-section p {
            margin: 4px 0;
        }

        .signature-section {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
            width: 60%;
        }

        .sig-line {
            display: flex;
            align-items: flex-end;
            gap: 10px;
        }

        .sig-line.with-signature {
            flex: 2;
        }

        .signature-underline {
            flex: 1;
            border-bottom: 1px solid #000;
            min-width: 200px;
            max-width: 300px;
            height: 30px;
            position: relative;
        }

        #printGuestSignature {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            text-align: center;
        }

        #printGuestSignature img {
            max-height: 30px;
            max-width: 100%;
        }

        .date-underline {
            border-bottom: 1px solid #000;
            min-width: 120px;
            max-width: 150px;
            text-align: center;
            position: relative;
            height: 30px;

        }

        #printSignatureDate {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
        }

        .office-use-box {
            border: 1px solid #ddd;
            padding: 5px;
            margin-top: 10px;
            background: white;
            border-radius: 3px;
        }

        .office-use-box .office-use-table {
            margin-bottom: 0;
            /* Remove bottom margin for the table inside this box */
        }

        @media print {
            body {
                background: white;
            }

            .page {
                margin: 0;
                padding: 10mm;
                box-shadow: none;
                border: none;
                height: 297mm;
                page-break-after: always;
            }
        }

        .title-cell {
            width: 100px;
        }

        .header-container {
            display: flex;
            align-items: center;
            padding: 8px 15px;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 15px;
            gap: 15px;
        }

        .logo-container {
            flex: 0 0 30%;
            height: 100%;
            display: flex;
            align-items: center;
        }

        .logo {
            width: 100%;
            height: auto;
            max-height: 1.6cm;
            object-fit: contain;
        }

        .contact-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 2px;
            font-size: 10px;
            line-height: 1.2;
        }
    </style>
</head>

<body>
    <div class="page">
        <div class="header-container">
            <div class="logo-container">
                <img src="TCB_LOGO.png" alt="TAMU Logo" class="logo">
            </div>
            <div class="contact-info">
                <div>Aras 8, No. 53, Jalan Raja Alang Kampung Baru, 53000 Kuala Lumpur</div>
                <div><strong>T:</strong> +603 2698 8789 | <strong>F:</strong> +603 2692 4789</div>
                <div style="color: #2563eb;"><strong>E:</strong> memberservices@tamucapital.com</div>
                <div>Voucher No: <span id="printVoucherNo"></span></div>
            </div>
        </div>

        <div class="main-title">PRESENTATION CHECK-IN FORM</div>
        <div class="sub-title">THANK YOU FOR ATTENDING OUR PRESENTATION TODAY. YOUR PARTICIPATION IS GREATLY
            APPRECIATED.</div>
        <div class="sub-title">HAVE A PLEASANT EXPERIENCE!!!</div>
        <div class="confidential-box">INFORMATION GIVEN HERE IS STRICTLY PRIVATE AND CONFIDENTIAL</div>

        <table class="details-table">
            <tr>
                <td class="title-cell">NAME (MR):</td>
                <td class="line" id="printGuestName"></td>
                <td>NRIC:</td>
                <td class="line" id="printGuestNric"></td>
                <td>AGE:</td>
                <td class="line" id="printGuestAge"></td>
            </tr>
            <tr>
                <td>NAME (MRS):</td>
                <td class="line" id="printPartnerName"></td>
                <td>NRIC:</td>
                <td class="line" id="printPartnerNric"></td>
                <td>AGE:</td>
                <td class="line" id="printPartnerAge"></td>
            </tr>
            <tr>
                <td>ADDRESS:</td>
                <td colspan="5" class="line" id="printAddress"></td>
            </tr>
            <tr>
                <td colspan="6" class="line" style="height: 1.5em;"></td>
            </tr>
            <tr>
                <td>EMAIL:</td>
                <td colspan="5" class="line" id="printEmail"></td>
            </tr>
            <tr>
                <td>(MR) H/P:</td>
                <td colspan="2" class="line" id="printGuestPhone"></td>
                <td>(MRS) H/P:</td>
                <td colspan="2" class="line" id="printPartnerPhone"></td>
            </tr>
        </table>

        <div class="section-title">PLEASE TICK WHERE APPLICABLE:-</div>
        <div class="flex-container">
            <div>MARITAL STATUS:</div>
            <div class="checkbox-item"><span class="box" id="printMaritalSingle"></span> SINGLE</div>
            <div class="checkbox-item"><span class="box" id="printMaritalMarried"></span> MARRIED</div>

            <div>| NUMBER OF CHILDREN:</div>
            <div class="line" id="printNumChildren" style="flex-grow: 1;"></div>
        </div>

        <div class="section-title">OCCUPATION:</div>
        <div class="occupation-row">
            <div class="company-label">HUSBAND:</div>
            <div class="line" id="printGuestOccupation"></div>
            <div class="company-label">INDUSTRY:</div>
            <div class="line" id="printGuestCompany"></div>
        </div>
        <div class="occupation-row">
            <div class="company-label">WIFE:</div>
            <div class="line" id="printPartnerOccupation"></div>
            <div class="company-label">INDUSTRY:</div>
            <div class="line" id="printPartnerCompany"></div>
        </div>

        <div class="section-title">GROSS MONTHLY INCOME (RM):</div>
        <div class="income-section">
            <div class="income-grid">
                <div class="income-column">
                    <div class="income-column-title">HUSBAND</div>
                    <div class="income-row">
                        <div class="income-checkbox">
                            <span class="box" id="printGuestIncome1"></span>
                            <span>RM1,000-RM2,000</span>
                        </div>
                        <div class="income-checkbox">
                            <span class="box" id="printGuestIncome2"></span>
                            <span>RM2,001-RM4,000</span>
                        </div>
                        <div class="income-checkbox">
                            <span class="box" id="printGuestIncome3"></span>
                            <span>RM4,001-RM6,000</span>
                        </div>
                    </div>
                    <div class="income-row">
                        <div class="income-checkbox">
                            <span class="box" id="printGuestIncome5"></span>
                            <span>RM10,001-RM15,000</span>
                        </div>
                        <div class="income-checkbox">
                            <span class="box" id="printGuestIncome6"></span>
                            <span>RM15,001-RM20,000</span>
                        </div>
                        <div class="income-checkbox">
                            <span class="box" id="printGuestIncome7"></span>
                            <span>RM20,001 ></span>
                        </div>
                    </div>
                </div>
                <div class="income-column">
                    <div class="income-column-title">WIFE</div>
                    <div class="income-row">
                        <div class="income-checkbox">
                            <span class="box" id="printPartnerIncome1"></span>
                            <span>RM1,000-RM2,000</span>
                        </div>
                        <div class="income-checkbox">
                            <span class="box" id="printPartnerIncome2"></span>
                            <span>RM2,001-RM4,000</span>
                        </div>
                        <div class="income-checkbox">
                            <span class="box" id="printPartnerIncome3"></span>
                            <span>RM4,001-RM6,000</span>
                        </div>
                    </div>
                    <div class="income-row">
                        <div class="income-checkbox">
                            <span class="box" id="printPartnerIncome5"></span>
                            <span>RM10,001-RM15,000</span>
                        </div>
                        <div class="income-checkbox">
                            <span class="box" id="printPartnerIncome6"></span>
                            <span>RM15,001-RM20,000</span>
                        </div>
                        <div class="income-checkbox">
                            <span class="box" id="printPartnerIncome7"></span>
                            <span>RM20,001 ></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="flex-container" style="margin-top: 15px;">
            <div>ARE YOU A CREDIT CARD HOLDER:-</div>
            <div class="checkbox-item"><span class="box" id="printCCYes"></span> YES</div>
            <div class="checkbox-item"><span class="box" id="printCCNo"></span> NO</div> |
            <div class="checkbox-item"><span class="box" id="printCCPlatinum"></span> PLATINUM</div>
            <div class="checkbox-item"><span class="box" id="printCCGold"></span> GOLD</div>
            <div class="checkbox-item"><span class="box" id="printCCClassic"></span> CLASSIC</div>
        </div>
        <div class="flex-container">
            <div>CARD ISSUING BANK:</div>
            <div class="line" id="printCCBank" style="flex-grow: 1;"></div>
        </div>

        <div class="consent-section">
            <div class="">CONSENT OF THE DATA PROTECTION AND PRIVACY:</div>
            <p>We assure you that all personal data will be treated as confidential and we will implement the
                appropriate steps of procedures in accordance with the law, rules and regulations to ensure the
                protection of personal data and prevent unauthorised and unlawful usage, accidental access or
                disclosure, alteration or destruction of your personal data.</p>
            <p>I agree that <strong>TAMU CAPITAL BERHAD</strong> shall have the right to use my personal data for the
                purpose of the
                operational process which might include transfer of data and personal information to its related
                companies, subsidiaries and/or its holding company,
                outsourcing partners, and solicitor but not limited to affiliate companies including their outsourcing
                partners. I further agree that <strong>TAMU CAPITAL BERHAD</strong> and
                its related companies, subsidiareis and/or its holding company can share and use my data and personal
                information for the purpose of promoting the
                company's and its related companies', subsidiaries' and/or its holding company's products, new services
                and support requirement, and marketing
                campaigns and activities and commercial transaction.</p>
        </div>

        <div class="signature-section">
            <div class="sig-line with-signature">
                <span>Signature:</span>
                <div class="signature-underline">
                    <div id="printGuestSignature"></div>
                </div>
            </div>
            <div class="sig-line">
                <span>Date:</span>
                <div class="date-underline">
                    <span id="printSignatureDate"></span>
                </div>
            </div>
        </div>

        <div class="office-use-box">
            <div class="section-title" style="text-align: center;">FOR OFFICE USE ONLY:</div>
            <table class="office-use-table">
                <tr>
                    <td style="width: 10%;">DAY:</td>
                    <td class="line" id="printOfficeDay" style="width: 40%;"></td>
                    <td style="width: 10%;">DATE:</td>
                    <td class="line" id="printOfficeDate" style="width: 40%;"></td>
                </tr>
                <tr>
                    <td style="width: 10%;">TIME IN:</td>
                    <td class="line" id="printOfficeTimeIn" style="width: 40%;"></td>
                    <td style="width: 10%;">TIME OUT:</td>
                    <td class="line" id="printOfficeTimeOut" style="width: 40%;"></td>
                </tr>
                <tr>
                    <td style="width: 10%;">TM CODE:</td>
                    <td class="line" id="printOfficeTmCode" style="width: 40%;"></td>
                    <td style="width: 10%;">CONSULTANT:</td>
                    <td class="line" id="printOfficeConsultant" style="width: 40%;"></td>
                </tr>
                <tr>
                    <td colspan="2" style="vertical-align: middle;">
                        <div class="flex-container" style="gap: 5px;">
                            <span class="checkbox-item"><span class="box" id="printOfficeStatusQT"></span> QT</span>
                            <span class="checkbox-item"><span class="box" id="printOfficeStatusNQ"></span> NQ</span>
                            <span class="checkbox-item"><span class="box" id="printOfficeStatusRescheduled"></span>
                                RESCHEDULED</span>
                        </div>
                    </td>
                    <td colspan="2" style="vertical-align: middle;">
                        <div class="flex-container" style="gap: 4px;">
                            <span style="width: 26%;">Voucher No:</span>
                            <span class="line" id="printOfficeVoucherNo"
                                style="display: inline-block; min-width: 80px; text-align: center;"></span>
                            <span class="checkbox-item" style="margin-left: 10px;"><span class="box"
                                    id="printVoucherHiTea"></span> HI-TEA</span>
                            <span class="checkbox-item"><span class="box" id="printVoucherStaycation"></span>
                                STAYCATION</span>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <script>
        window.onload = function () {
            const dataString = localStorage.getItem('tamuPrintData');
            if (!dataString) {
                document.body.innerHTML = '<h1>Error: No data found. Please generate from the main form.</h1>';
                return;
            }
            const data = JSON.parse(dataString);
            const p1 = data.part1;

            const setText = (id, value) => {
                const el = document.getElementById(id);
                if (el && value !== undefined && value !== null) {
                    // Keep email addresses in their original case, make everything else uppercase
                    el.textContent = id === 'printEmail' ? value : String(value).toUpperCase();
                }
            };
            const setCheck = (id) => { const el = document.getElementById(id); if (el) el.textContent = 'âœ“'; };
            const setSignature = (id, url) => { const container = document.getElementById(id); if (container && url) { const img = document.createElement('img'); img.src = url; img.style = "max-height: 50px; max-width: 180px;"; container.appendChild(img); } };
            const calculateAge = (dob) => {
                if (!dob) return '';
                const birthDate = new Date(dob);
                const today = new Date();
                let age = today.getFullYear() - birthDate.getFullYear();
                const m = today.getMonth() - birthDate.getMonth();
                if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) { age--; }
                return age;
            };

            // Determine guest and partner info based on gender
            const guestInfo = p1.guestInfo || {};
            const partnerInfo = p1.partnerInfo || {};
            const guestBusiness = p1.guestBusiness || {};
            const partnerBusiness = p1.partnerBusiness || {};

            // Populate guest and partner info
            setText('printGuestName', guestInfo.fullName);
            setText('printGuestNric', guestInfo.icPassport);
            setText('printGuestAge', calculateAge(guestInfo.dob));
            setText('printGuestPhone', guestInfo.phone);
            setText('printPartnerName', partnerInfo.fullName);
            setText('printPartnerNric', partnerInfo.icPassport);
            setText('printPartnerAge', calculateAge(partnerInfo.dob));
            setText('printPartnerPhone', partnerInfo.phone);

            // Construct and populate address
            const address = [
                guestInfo.correspondentAddress,
                guestInfo.poskod,
                guestInfo.city,
                guestInfo.state
            ].filter(Boolean).join(', ');
            setText('printAddress', address);
            setText('printEmail', guestInfo.email);
            setText('printNumChildren', guestInfo.numChildren);

            // Populate marital status
            if (guestInfo.maritalStatus) {
                if (guestInfo.maritalStatus.toUpperCase() === 'SINGLE') setCheck('printMaritalSingle');
                if (guestInfo.maritalStatus.toUpperCase() === 'MARRIED') setCheck('printMaritalMarried');
            }

            // Populate occupation and business info
            setText('printGuestOccupation', guestBusiness.occupation);
            setText('printGuestCompany', guestBusiness.industry);
            setText('printPartnerOccupation', partnerBusiness.occupation);
            setText('printPartnerCompany', partnerBusiness.industry);

            // Populate income checkboxes
            const setIncomeCheck = (income, prefix) => {
                if (!income) return;
                const incomeMap = {
                    '1,000-2,000': '1',
                    '2,001-4,000': '2',
                    '4,001-6,000': '3',
                    '6,001-10,000': '4',
                    '10,001-15,000': '5',
                    '15,001-20,000': '6',
                    '20,001 and above': '7'
                };
                const boxId = prefix + incomeMap[income];
                if (boxId) setCheck(boxId);
            };
            setIncomeCheck(guestBusiness.monthlyIncome, 'printGuestIncome');
            setIncomeCheck(partnerBusiness.monthlyIncome, 'printPartnerIncome');

            // Populate credit card information
            const bankInfo = p1.guestBankInfo || {};
            if (bankInfo.isCreditCardHolder === 'Yes') setCheck('printCCYes');
            if (bankInfo.isCreditCardHolder === 'No') setCheck('printCCNo');
            if (bankInfo.creditCardType) {
                if (bankInfo.creditCardType.toUpperCase() === 'PLATINUM') setCheck('printCCPlatinum');
                if (bankInfo.creditCardType.toUpperCase() === 'GOLD') setCheck('printCCGold');
                if (bankInfo.creditCardType.toUpperCase() === 'CLASSIC') setCheck('printCCClassic');
            }
            setText('printCCBank', bankInfo.cardIssuingBank);

            // Populate signature and date
            if (p1.guestCheckInSignature) {
                setSignature('printGuestSignature', p1.guestCheckInSignature.signatureData);
                setText('printSignatureDate', p1.guestCheckInSignature.date);
            }

            // Populate Office Use Only section
            const officeUse = p1.officeUse || {};
            setText('printOfficeDay', officeUse.day);
            setText('printOfficeDate', officeUse.date);
            setText('printOfficeTimeIn', officeUse.timeIn);
            setText('printOfficeTimeOut', officeUse.timeOut);
            setText('printOfficeTmCode', officeUse.tmCode);
            setText('printOfficeConsultant', officeUse.consultant);

            if (officeUse.status) {
                if (officeUse.status.toUpperCase() === 'QT') setCheck('printOfficeStatusQT');
                if (officeUse.status.toUpperCase() === 'NQ') setCheck('printOfficeStatusNQ');
                if (officeUse.status.toUpperCase() === 'RESCHEDULED') setCheck('printOfficeStatusRescheduled');
            }

            // Populate voucher information
            setText('printVoucherNo', officeUse.voucherNo);
            setText('printOfficeVoucherNo', officeUse.voucherNo);
            if (officeUse.voucherType) {
                if (officeUse.voucherType.toUpperCase() === 'HI-TEA') setCheck('printVoucherHiTea');
                if (officeUse.voucherType.toUpperCase() === 'STAYCATION') setCheck('printVoucherStaycation');
            }

            setTimeout(() => { window.print(); }, 500);
        };
    </script>
</body>

</html>