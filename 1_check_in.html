<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>TAMU Check-In Form - Print Preview</title>
    <style>
        /* Base page setup for A4 */
        body {
            font-family: Arial, sans-serif;
            font-size: 8pt;
            background-color: #EEE;
            margin: 0;
        }

        .page {
            background: white;
            width: 210mm;
            height: 297mm;
            padding: 10mm;
            margin: 10mm auto;
            box-sizing: border-box;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        }

        .consent-section p {
            margin: 4px 0;
            text-align: justify;
            /* MODIFIED: Justified text alignment */
        }

        /* Base table styles - reduced spacing */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 8px;
            border: 1px solid #ddd;
        }

        td {
            padding: 4px 4px;
            vertical-align: middle;
        }

        /* Form sections - optimized spacing */
        .details-table,
        .office-use-table {
            background: white;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            border-radius: 3px;
            margin-bottom: 12px;
        }

        .details-table td,
        .office-use-table td {
            padding: 4px 6px;
            border-bottom: 1px solid #eee;
        }

        .line {
            border-bottom: 1px solid #ccc;
            min-height: 1.2em;
            padding: 2px 4px;
            font-weight: normal;
            font-size: 9pt;
            background: #f9f9f9;
            border-radius: 2px;
        }

        /* Checkbox styling - compact */
        .checkbox-item {
            display: inline-flex;
            align-items: center;
            margin: 0 10px 0 0;
            padding: 2px 0;
        }

        .box {
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 1px solid #ccc;
            border-radius: 2px;
            text-align: center;
            line-height: 12px;
            margin-right: 4px;
            background: white;
        }

        /* Section titles - reduced margins */
        .section-title {
            font-weight: 600;
            margin: 12px 0 6px;
            padding-bottom: 3px;
            border-bottom: 2px solid #eee;
            color: #333;
        }

        /* Header styling - compact */
        .header-box {
            border: 1px solid #ddd;
            padding: 8px;
            width: 180px;
            font-size: 8pt;
            line-height: 1.3;
            background: white;
            border-radius: 3px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .main-title {
            text-align: center;
            font-weight: 600;
            font-size: 13pt;
            margin: 15px 0 8px;
            color: #333;
        }

        .sub-title {
            text-align: center;
            font-weight: normal;
            font-size: 8.5pt;
            margin: 4px 0;
            color: #666;
        }

        .confidential-box {
            border: 2px solid #e0e0e0;
            padding: 6px;
            text-align: center;
            font-weight: 600;
            margin: 12px 0;
            background: #f8f8f8;
            border-radius: 3px;
            color: #444;
        }

        /* Occupation section - single row layout */
        .flex-container {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 4px 0;
        }

        .occupation-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 4px 0;
        }

        .occupation-row>div:first-child {
            width: 80px;
            flex-shrink: 0;
        }

        .occupation-row .line {
            flex: 1;
            margin-right: 10px;
        }

        .company-label {
            width: 50px;
            flex-shrink: 0;
        }

        /* Income section - compact single column */
        .income-section {
            margin: 8px 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 3px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            padding: 8px;
        }

        .income-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 4px 0;
        }

        .income-row>div:first-child {
            width: 80px;
            flex-shrink: 0;
        }

        .income-options {
            display: flex;
            flex-wrap: nowrap;

            gap: 15px;
        }

        .checkbox-item {
            display: inline-flex;
            align-items: center;
            margin: 0;
            padding: 2px 0;
            white-space: nowrap;
        }

        /* Consent section - reduced size */
        .consent-section {
            font-size: 7.5pt;
            margin: 15px 0;
            padding: 10px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 3px;
            line-height: 1.3;
        }

        .consent-section p {
            margin: 4px 0;
        }

        /* Signature section - reduced spacing */
        .signature-section {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding: 0 15px;
        }

        .sig-line {
            width: 45%;
            border-top: 1px solid #ccc;
            padding-top: 6px;
            color: #666;
        }

        /* Office use section - compact */
        .office-use-box {
            border: 1px solid #ddd;
            padding: 5px;
            margin-top: 10px;
            background: white;
            border-radius: 3px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        /* Print styles */
        @media print {
            body {
                background: white;
            }

            .page {
                margin: 0;
                padding: 10mm;
                box-shadow: none;
                border: none;
                height: 297mm;
            }

            .details-table,
            .income-col,
            .office-use-box,
            .header-box {
                box-shadow: none;
                border: 1px solid #ccc;
            }

            /* Force page breaks */
            .page {
                page-break-after: always;
            }
        }

        .title-cell {
            width: 100px;
            /* Adjust as needed */
        }

        .header-container {
            display: flex;
            align-items: center;

            padding: 8px 15px;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 15px;
            gap: 15px;
        }

        .logo-container {
            flex: 0 0 30%;
            height: 100%;
            display: flex;
            align-items: center;
        }

        .logo {
            width: 100%;
            height: auto;
            max-height: 1.6cm;
            object-fit: contain;
        }

        .contact-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 2px;
            font-size: 10px;
            line-height: 1.2;
        }

        .address {
            color: #333;
            margin-bottom: 2px;
        }

        .contact-line {
            color: #555;
            font-size: 9px;
        }

        .email-line {
            color: #2563eb;
            font-size: 9px;
        }
    </style>
</head>

<body>
    <div class="page">
        <div class="header-container">
            <div class="logo-container">
                <img src="TCB_LOGO.png" alt="TAMU Logo" class="logo">
            </div>
            <div class="contact-info">
                <div class="address">
                    51C-L1 Mezzanine Floor Bangunan Podium 53, Jalan Raja Alang Kampung Baru, 53000 Kuala Lumpur
                </div>
                <div class="contact-line">
                    <strong>T:</strong> +603 2698 8789 &nbsp;|&nbsp; <strong>F:</strong> +603 2692 4789
                </div>
                <div class="email-line">
                    <strong>E:</strong> memberservices@tamucapital.com
                </div>
                <div class="voucher-no">Voucher No: <span id="printVoucherNo"></span></div>
            </div>
        </div>

        <div class="main-title">PRESENTATION CHECK - IN FORM</div>
        <div class="sub-title">THANK YOU FOR ATTENDING OUR PRESENTATION TODAY. YOUR PARTICIPATION IS GREATLY
            APPRECIATED.</div>
        <div class="sub-title">HAVE A PLEASANT EXPERIENCE!!!</div>

        <div class="confidential-box">INFORMATION GIVEN HERE IS STRICTLY PRIVATE AND CONFIDENTIAL</div>

        <table class="details-table">
            <tr>
                <td class="title-cell">NAME (MR):</td>
                <td class="line" id="printGuestName"></td>
                <td>NRIC:</td>
                <td class="line" id="printGuestNric"></td>
                <td>AGE:</td>
                <td class="line" id="printGuestAge"></td>
            </tr>
            <tr>
                <td>NAME (MRS):</td>
                <td class="line" id="printPartnerName"></td>
                <td>NRIC:</td>
                <td class="line" id="printPartnerNric"></td>
                <td>AGE:</td>
                <td class="line" id="printPartnerAge"></td>
            </tr>
            <tr>
                <td>ADDRESS:</td>
                <td colspan="5" class="line" id="printAddress"></td>
            </tr>
            <tr>
                <td colspan="6" class="line" style="height: 1.5em;"></td>
            </tr>
            <tr>
                <td>EMAIL:</td>
                <td colspan="5" class="line" id="printEmail"></td>
            </tr>
            <tr>
                <td>(MR) H/P:</td>
                <td colspan="2" class="line" id="printGuestPhone"></td>
                <td>(MRS) H/P:</td>
                <td colspan="2" class="line" id="printPartnerPhone"></td>
            </tr>
        </table>

        <div class="section-title">PLEASE TICK WHERE APPLICABLE:-</div>
        <div class="flex-container">
            <div>MARITAL STATUS:</div>
            <div class="checkbox-item"><span class="box" id="printMaritalSingle"></span> SINGLE</div>
            <div class="checkbox-item"><span class="box" id="printMaritalMarried"></span> MARRIED</div>
            <div class="checkbox-item"><span class="box" id="printMaritalOthers"></span> OTHERS</div>

            <div>| NUMBER OF CHILDREN:</div>
            <div class="line" id="printNumChildren" style="flex-grow: 1;"></div>
        </div>

        <div class="section-title">OCCUPATION:</div>
        <div class="occupation-row">
            <div class="company-label">HUSBAND:</div>
            <div class="line" id="printGuestOccupation"></div>
            <div class="company-label">COMPANY:</div>
            <div class="line" id="printGuestCompany"></div>
        </div>
        <div class="occupation-row">
            <div class="company-label">WIFE:</div>
            <div class="line" id="printPartnerOccupation"></div>
            <div class="company-label">COMPANY:</div>
            <div class="line" id="printPartnerCompany"></div>
        </div>

        <div class="section-title">GROSS MONTHLY INCOME:</div>
        <div class="income-section">
            <div class="income-row">
                <div class="company-label">HUSBAND:</div>
                <div class="income-options row">
                    <div class="checkbox-item"><span class="box" id="printGuestIncome1"></span> RM4k - RM6k</div>
                    <div class="checkbox-item"><span class="box" id="printGuestIncome2"></span> RM6,001 - RM10,000</div>
                    <div class="checkbox-item"><span class="box" id="printGuestIncome3"></span> RM10,001 - RM 15,000
                    </div>
                    <div class="checkbox-item"><span class="box" id="printGuestIncome4"></span> RM15,001 - RM 20,000
                    </div>
                    <div class="checkbox-item"><span class="box" id="printGuestIncome5"></span> RM20,001 > </div>
                </div>
            </div>
            <div class="income-row">
                <div class="company-label">WIFE:</div>
                <div class="income-options">
                    <div class="checkbox-item"><span class="box" id="printPartnerIncome1"></span> RM4k - RM6k
                    </div>
                    <div class="checkbox-item"><span class="box" id="printPartnerIncome2"></span> RM6,001 - RM10,000
                    </div>
                    <div class="checkbox-item"><span class="box" id="printPartnerIncome3"></span> RM10,001 - RM15,000
                    </div>
                    <div class="checkbox-item"><span class="box" id="printPartnerIncome4"></span> RM15,001 - RM 20,000
                    </div>
                    <div class="checkbox-item"><span class="box" id="printPartnerIncome5"></span> RM20,001 ></div>
                </div>
            </div>
        </div>

        <div class="flex-container" style="margin-top: 15px;">
            <div>ARE YOU A CREDIT CARD HOLDER:-</div>
            <div class="checkbox-item"><span class="box" id="printCCYes"></span> YES</div>
            <div class="checkbox-item"><span class="box" id="printCCNo"></span> NO</div>
            |
            <div class="checkbox-item"><span class="box" id="printCCPlatinum"></span> PLATINUM</div>
            <div class="checkbox-item"><span class="box" id="printCCGold"></span> GOLD</div>
            <div class="checkbox-item"><span class="box" id="printCCClassic"></span> CLASSIC</div>
        </div>
        <div class="flex-container">
            <div>CARD ISSUING BANK:</div>
            <div class="line" id="printCCBank" style="flex-grow: 1;"></div>
        </div>

        <div class="consent-section">
            <div class="section-title">CONSENT OF THE DATA PROTECTION AND PRIVACY:</div>
            <p>We assure you that all personal data will be treated as confidential and we will implement the
                appropriate steps of procedures in accordance with the law, rules and regulations to ensure the
                protection of personal data and prevent unauthorised and unlawful usage, accidental access or
                disclosure, alteration or destruction of your personal data.</p>
            <p>I agree that <strong>TAMU CAPITAL BERHAD</strong> shall have the right to use my personal data for the
                purpose of the operational process which might include transfer of data and personal information to its
                related companies, subsidiaries and/or its holding company, outsourcing partners, and solicitor but not
                limited to affiliate companies including their outsourcing partners. I further agree that TAMU CAPITAL
                BERHAD and its related companies, subsidiareis and/or its holding company can share and use my data and
                personal information for the purpose of promoting the company's and its related companies',
                subsidiaries' and/or its holding company's products, new services and support requirement, and marketing
                campaigns and activities and commercial transaction.</p>
        </div>

        <div class="signature-section">
            <div class="sig-line"><span>Signature:</span></div>
            <div class="sig-line"><span>Date:</span></div>
        </div>

        <div class="office-use-box">
            <div class="section-title" style="text-align: center;">FOR OFFICE USE ONLY:</div>
            <table class="office-use-table">
                <tr>
                    <td style="width: 20%;">DAY:</td>
                    <td class="line"></td>
                    <td style="width: 20%;">DATE:</td>
                    <td class="line"></td>
                </tr>
                <tr>
                    <td style="width: 20%;">TIME IN:</td>
                    <td class="line"></td>
                    <td style="width: 20%;">TIME OUT:</td>
                    <td class="line"></td>
                </tr>
                <tr>
                    <td style="width: 20%;">TM CODE:</td>
                    <td class="line"></td>
                    <td style="width: 20%;">CONSULTANT:</td>
                    <td class="line"></td>
                </tr>
            </table>
            <div class="flex-container" style="margin-top: 10px; justify-content: space-around;">
                <div class="checkbox-item"><span class="box"></span> QT</div>
                <div class="checkbox-item"><span class="box"></span> NQ</div>
                <div class="checkbox-item"><span class="box"></span> RESCHEDULED</div>
            </div>
        </div>
    </div>

    <script>
        window.onload = function () {
            const dataString = localStorage.getItem('tamuPrintData');
            if (!dataString) {
                document.body.innerHTML = '<h1>Error: No data found. Please generate from the main form.</h1>';
                return;
            }
            const data = JSON.parse(dataString);
            const p1 = data.part1;

            const setText = (id, value) => { const el = document.getElementById(id); if (el && value) el.textContent = value; };
            const setCheck = (id) => { const el = document.getElementById(id); if (el) el.textContent = '✓'; };
            const calculateAge = (dob) => {
                if (!dob) return '';
                const birthDate = new Date(dob);
                const today = new Date();
                let age = today.getFullYear() - birthDate.getFullYear();
                const m = today.getMonth() - birthDate.getMonth();
                if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                    age--;
                }
                return age;
            };

            // Determine who is Mr. and Mrs. based on gender
            let guestIsMr = p1.guestInfo.gender === 'Male';
            let partnerIsMrs = p1.partnerInfo.fullName && p1.partnerInfo.gender === 'Female';

            const mrInfo = guestIsMr ? p1.guestInfo : (p1.partnerInfo.gender === 'Male' ? p1.partnerInfo : {});
            const mrsInfo = partnerIsMrs ? p1.partnerInfo : (p1.guestInfo.gender === 'Female' ? p1.guestInfo : {});

            const mrBiz = guestIsMr ? p1.guestBusiness : (p1.partnerInfo.gender === 'Male' ? p1.partnerBusiness : {});
            const mrsBiz = partnerIsMrs ? p1.partnerBusiness : (p1.guestInfo.gender === 'Female' ? p1.guestBusiness : {});

            // Populate fields
            setText('printGuestName', mrInfo.fullName);
            setText('printGuestNric', mrInfo.icPassport);
            setText('printGuestAge', calculateAge(mrInfo.dob));
            setText('printGuestPhone', mrInfo.phone);

            setText('printPartnerName', mrsInfo.fullName);
            setText('printPartnerNric', mrsInfo.icPassport);
            setText('printPartnerAge', calculateAge(mrsInfo.dob));
            setText('printPartnerPhone', mrsInfo.phone);

            setText('printAddress', `${p1.guestInfo.correspondentAddress}, ${p1.guestInfo.poskod} ${p1.guestInfo.city}`);
            setText('printEmail', p1.guestInfo.email);
            setText('printNumChildren', p1.guestInfo.numChildren);

            if (p1.guestInfo.maritalStatus === 'Single') setCheck('printMaritalSingle');
            if (p1.guestInfo.maritalStatus === 'Married') setCheck('printMaritalMarried');
            if (p1.guestInfo.maritalStatus === 'Others') setCheck('printMaritalOthers');

            setText('printGuestOccupation', mrBiz.occupation);
            setText('printGuestCompany', mrBiz.industry);
            setText('printPartnerOccupation', mrsBiz.occupation);
            setText('printPartnerCompany', mrsBiz.industry);

            const setIncomeCheck = (income, prefix) => {
                if (!income) return;
                if (income === '4,000-6,000') setCheck(prefix + '1');
                if (income === '6,001-10,000') setCheck(prefix + '2');
                if (income === '10,001-15,000') setCheck(prefix + '3');
                if (income === '15,001-20,000') setCheck(prefix + '4');
                if (income === '20,001 and above') setCheck(prefix + '5');
            };

            setIncomeCheck(mrBiz.monthlyIncome, 'printGuestIncome');
            setIncomeCheck(mrsBiz.monthlyIncome, 'printPartnerIncome');

            // After a short delay, trigger the print dialog
            setTimeout(() => {
                window.print();
            }, 500);
        };
    </script>
</body>

</html>